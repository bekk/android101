<!DOCTYPE html>
<html lang="nb">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Manuscript</title>
        <meta name="viewport" content="width=device-width">

        <link rel="stylesheet" href="/android101/css/syntax.css">
        <link href="/android101/css/bootstrap.min.css" rel="stylesheet" media="screen">
        <link rel="stylesheet" href="/android101/css/main.css">
        <script src="/android101/js/jquery.min.js"></script>
        <script src="/android101/js/bootstrap.min.js"></script>

    </head>
    <body>
      <div class="container-fluid main">
        <div class="row-fluid">
          <div class="span8">
            <h1 class="page-header">Manuscript</h1>
            <h3>Introduction</h3>
<li>Who are we, where do we work and what experience do we have with Android? </li>
<li>What are we presenting today? We will live code an application and show how the different components work. The app will allow the user to search for a Spotify track, and play the found track on a device</li>
<li> Afterwards, you will do assignments where the goal is to create a Twitter like app which communicates with a REST API</li>
<li> Please ask questions.</li>
<li> How many have brought devices/installed emulators?  </li>
<li> If you do not have a device or an emulator, join those who do.</li>
<li>Mention that participants do not have to write anything during live coding. All example code is on github</li>

<h3>Main</h3>
<ol>
    <li>Open Android Studio. Decribe that it is the standard IDE choice. Create an empty project. Briefly mention what an Activity is, along with the xml layout.</li>
    <li> Say that we use Gradle instead of Maven, as it is Googles' top choice </li>
    <li> Create simple activity (Choose Empty activity) </li>
    <li> Briefly explain the package system in Android Studio</li>
    <li>Explain the Android Manifest</li>
    <li>Explain Activities and onCreate() (<a href="android-app-structure-and-components.html"> App Structure And Components</a>)</li>
    <code><p>An activity can be seen as a controller in an MVC pattern. </p>
    <p>It is a single focused screen the user can interact with. It is responsible for creating a view, and coordinating interaction and state.</p>
    <p>An application typically has multiple Activities, and during use, switches between them</p>
    <p>An activity goes through a life cycle, and we have hooks where we can perform operations at given states. First is onCreate()</p>
    </code>
    <li>Say that we need to register our Activity here and register SpotifyActivity in the Android Manifest</li>
    <li> Say that we now need to create a layout for our activity</li>
    <li>Explain the UI builder</li>
    <li>Explain layouts and layout controls (<a href="common-view-controls.html"> Common View Controls</a>), (<a href="view-layout.html"> View Layout</a>)).</li>
          <code><p>LinearLayout: Positions element either in a single row or column, based on orientation.</p>
        <p>Can adjust and move elements by using the gravity property</p>
        <p>Relative Layout: Positions elements relative to each other or the parent container.</p>
        <p> Position is controlled by positioning attributes</p></code>
    <li>Update the MainActivity layout. It will display an input text field and a button. Mention that Linear and Relative are the most popular ones. Also mention FrameLayout</li>

    <li>Show use of match_parent and wrap_content, as well as difference between horizontal and vertical.</li>
    <li>Show use of gravity and layout_gravity (parent container) and explain difference</li>
    <li>Switch to RelativeLayout and experiment with match_parent and wrap_content</li>
    <li>Show relational parameters (below, left of)</li>
    <li>Say that we prefer to use RelativeLayout for Complex layouts, but that you can nest layouts as well</li>
    <li> Connect the layout to our Activity with setContentView() and explain the use of R</li>
         <code> <p>The R file is a generated file that hold references to all resources in your app.</p>
        <p>These are resources souch as images and drawables, layout files and strings</p></code>
    <li>Run Hello World app and explain debugging. Mention that we need either an emulator or a device. If you have a device, don't forget
        to enable developer options</li>
    <li> Add hook for onResume() and onDestroy(), and add log statements</li>
    <li> Run the app and show the different states </li>
    <li> Connect view elements in Java code </li>
     <li>Create a click listener for the button. This is where we want to initiate the search. For now, add a Toast, and run the app.</li>
    <li>
        <strong>ASSIGNMENT 1A</strong> It's time for the first assignment. Open Wiki in browser, and say that this contains all info needed. Menu on the right hand side.<br>
        Enter the assignments page. Describe the task (create a Twitter like app), then describe the backend. Finally, describe assignment 1A.<br>
        <code>PAUSE WHILE PARTICIPANTS DO ASSIGNMENT 1A</code>
    </li>
    <li>Replace the Toast with an Intent which we will use to start the TracksActivity. Describe intents</li>
    <code><p>Intents are Android's way of communicating between components such as Activities and Services. We can use intents to launch activities and
            pass data between them.</p>
            <p>Explicit Intents: Explicitly declare which activity to start</p>
            <p>Implicit Intents: Declares an action to start, which allows components listening for this action to respond to it.</p>
            <p>An example is when you want to open a location in Google Maps in Chrome.</p>
            <p>You are then presented with the option to open Maps in either the Maps app or the browser.</p>
            <p>This is possible as both of the apps are listening for the intent in their declared intent filter.</p>
            <p>Intent filters describe which types of implicit intents can be received.</p>
            <p> Another example is to switch out stock SMS app</p></code>
    <li>Create the TracksActivity. TracksActivity will perform the actual search, and display a list containing the search results. Add entries to the Android Manifest</li>
    <li>Start TracksActivity from MainActivity, and also pass the search input as an extra. Retrieve the bundle in TracksActivity.</li>
    <li>Explain that we now want to set up a service for performing the search. Explain AsyncTasks (<a href="working-in-the-background.html"> Working In the Background.</a>)
        Say that for this course we will use Retrofit, and provide Retrofit basics (background thread, GSON, etc).
      <code><p>Retrofit is a library for turning your Rest API into a Java Interface.</p>
        <p> It handles moving the network call into a background thread, parsing JSON with GSON, and returning the result to the UI thread.</p></code>
        Add Gradle dependency and say that retrofit2.0 requires a converter in order to parse JSON:
        <p><code>compile 'com.squareup.retrofit2:retrofit:2.0.0-beta3'</code></p>
        <p><code>compile 'com.squareup.retrofit2:converter-gson:2.0.0-beta3'</code></p>
    <li>Add SpotifySearchService which is the Retrofit interface. Maybe live code this. Also, add URL as a final variable to the MainActivity.
        <p><code>https://api.spotify.com</code></p>
        <p><code>"/v1/search"</code></p>
    </li>
    <li> Create the Result object and explain its connection to the JSON structure returned by the Spotify API. It will hold a Tracks object, which in turn will hold a list of items</li>
    <li> Create the Tracks object, which will contain a list of Track. Copy this</li>
    <li> Create the Artist and Track domain objects. Copy these</li>
    <li> Create an instance of RestAdapter, and use this to instantiate the SpotifySearchService. Add the rest call to the created click listener. </li>
    <li> Run the app and perform a search. Add a Toast to the success callback, and also log if success or error. Remember to log error</li>

    <li>Do not add internet permission until app has run and failed. Explain the need for permissions</li>
    <figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.INTERNET&quot;</span> <span class="nt">/&gt;</span></code></pre></figure>
    <li>Run app again and see that the Toast pops up</li>

    <li>
        <strong>ASSIGNMENT 1B</strong> Describe assignment 1B (displaying messages using Retrofit).
        <p><code>PAUSE WHILE PARTICIPANTS DO ASSIGNMENT 1B / SWITCH PRESENTER</code></p>
    </li>

    <li>Remove <code>Toast</code> and explain that we now want to display the data in a list </li>
    <li>
        Explain that a <code>RecyclerView</code> can be used for displaying the results (<a href="list-recycler-view.html"> Lists and RecyclerView)</a>
        <div>
            <h4>RecyclerView</h4>
            <p>
                RecyclerView is a subclass of ViewGroup. It displays a list of child View objects, one for each item in your list of items. If you have 100 items in the list, the RecyclerView will only create e.g. 12 views, just enough to fill the visible part of the screen. When you scroll, it will reuse these views and just update the data inside them - it recycles views over and over.
            </p>
        </div>
        <div>
            <h4>ViewHolders and Adapters</h4>
            <p>
                RecyclerView only recycles views and positions them on screen. To create the views we will use a RecyclerView.Adapter subclass and a RecyclerView.ViewHolder subclass. The ViewHolder only does one thing: Hold on to a view and subviews inside it. The RecyclerView does not create these ViewHolders itself, instead it asks an Adapter to create them. The Adapter is responsible for creating the necessary ViewHolders and then populating them with data for each item. RecyclerView first asks the Adapter how many items it has using getItemCount(). Then it wants to create the view holder using createViewHolder(). Finally it wants to bind the data for this item using bindViewHolder(). It then repeats this for all the items in the list.
            </p>
        </div>
    </li>
    <code>compile 'com.android.support:recyclerview-v7:+'</code>
    <li>Add the recyclerview in tracks_activity.xml. android.support.v7.widget.RecyclerView</id>
    <li>Create a layout for each track, item_track.xml. Add two textviews, one for artist another for track name.</li>
    <li>Get the recyclerview in TracksActivity and set a LinearLayoutManager.</li>
    <li>Create a TracksAdapter with an inner view holder class.</li>
    <li>The TracksAdapter needs a reference to a List of tracks and a Context (for creating layout inflater).</li>
    <li>Implement onBind (set text of views inside view holder) and onCreate (inflate item_track.xml).</li>
    <li>Go back to TracksActivity and setAdapter on the recyclerview.</li>
    <li>Remove toast in retrofit success callback and clear the tracklist and add all new tracks. Remember to notify adapter.</li>
    <li>Test app.</li>
    <li>Set onclicklistener on the view in view holder. Notify activity via a delegate interface.</li>
    <li>In TracksActivity, create implicit intent with action view and uri.parse(href). Check with packageManager if activity for intent exists. startActivity(intent).</li>
    <li>Describe the rest of the assignments.</li>
    <li>Quick break. We will be here to assist you</li>
</ol>

<img src="../img/recyclerviewsequence.jpg" />

<h3> MainActivity</h3>
<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="n">ActionBarActivity</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Button</span> <span class="n">searchButton</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">EditText</span> <span class="n">searchInputView</span><span class="o">;</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">);</span>

        <span class="n">searchButton</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">search_button</span><span class="o">);</span>
        <span class="n">searchInputView</span> <span class="o">=</span> <span class="o">(</span><span class="n">EditText</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">input_view</span><span class="o">);</span>

        <span class="n">searchButton</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">String</span> <span class="n">input</span> <span class="o">=</span> <span class="n">searchInputView</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>
                <span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Intent</span><span class="o">(</span><span class="n">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">TracksActivity</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="s">&quot;input&quot;</span><span class="o">,</span> <span class="n">input</span><span class="o">);</span>
                <span class="n">startActivity</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">});</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>
<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="o">&lt;</span><span class="n">RelativeLayout</span> <span class="nl">xmlns:</span><span class="n">android</span><span class="o">=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class="nl">xmlns:</span><span class="n">tools</span><span class="o">=</span><span class="s">&quot;http://schemas.android.com/tools&quot;</span> <span class="nl">android:</span><span class="n">layout_width</span><span class="o">=</span><span class="s">&quot;match_parent&quot;</span>
    <span class="nl">android:</span><span class="n">layout_height</span><span class="o">=</span><span class="s">&quot;match_parent&quot;</span> <span class="nl">android:</span><span class="n">paddingLeft</span><span class="o">=</span><span class="s">&quot;@dimen/activity_horizontal_margin&quot;</span>
    <span class="nl">android:</span><span class="n">paddingRight</span><span class="o">=</span><span class="s">&quot;@dimen/activity_horizontal_margin&quot;</span>
    <span class="nl">android:</span><span class="n">paddingTop</span><span class="o">=</span><span class="s">&quot;@dimen/activity_vertical_margin&quot;</span>
    <span class="nl">android:</span><span class="n">paddingBottom</span><span class="o">=</span><span class="s">&quot;@dimen/activity_vertical_margin&quot;</span> <span class="nl">tools:</span><span class="n">context</span><span class="o">=</span><span class="s">&quot;.MainActivity&quot;</span><span class="o">&gt;</span>

    <span class="o">&lt;</span><span class="n">EditText</span>
        <span class="nl">android:</span><span class="n">layout_width</span><span class="o">=</span><span class="s">&quot;match_parent&quot;</span>
        <span class="nl">android:</span><span class="n">layout_height</span><span class="o">=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="nl">android:</span><span class="n">id</span><span class="o">=</span><span class="s">&quot;@+id/input_view&quot;</span><span class="o">/&gt;</span>

    <span class="o">&lt;</span><span class="n">Button</span>
        <span class="nl">android:</span><span class="n">layout_width</span><span class="o">=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="nl">android:</span><span class="n">layout_height</span><span class="o">=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="nl">android:</span><span class="n">text</span><span class="o">=</span><span class="s">&quot;@string/search_button_text&quot;</span>
        <span class="nl">android:</span><span class="n">id</span><span class="o">=</span><span class="s">&quot;@+id/search_button&quot;</span>
        <span class="nl">android:</span><span class="n">layout_below</span><span class="o">=</span><span class="s">&quot;@id/input_view&quot;</span>
        <span class="nl">android:</span><span class="n">layout_centerHorizontal</span><span class="o">=</span><span class="s">&quot;true&quot;</span>
        <span class="nl">android:</span><span class="n">layout_marginTop</span><span class="o">=</span><span class="s">&quot;15dp&quot;</span><span class="o">/&gt;</span>
<span class="o">&lt;/</span><span class="n">RelativeLayout</span><span class="o">&gt;</span></code></pre></figure>




<h3> Retrofit SpotifySearchService</h3>
<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">SpotifyService</span> <span class="o">{</span>
    <span class="nd">@GET</span><span class="o">(</span><span class="s">&quot;/v1/search&quot;</span><span class="o">)</span>
    <span class="n">Call</span><span class="o">&lt;</span><span class="n">TrackResponse</span><span class="o">&gt;</span> <span class="nf">searchForTrack</span><span class="o">(</span><span class="nd">@Query</span><span class="o">(</span><span class="s">&quot;q&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">input</span><span class="o">,</span> <span class="nd">@Query</span><span class="o">(</span><span class="s">&quot;type&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">type</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>


<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">RestAdapter</span> <span class="n">adapter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RestAdapter</span><span class="o">.</span><span class="na">Builder</span><span class="o">()</span>
             <span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="s">&quot;https://api.spotify.com&quot;</span><span class="o">)</span>
             <span class="o">.</span><span class="na">build</span><span class="o">();</span>
<span class="n">SpotifyService</span> <span class="n">spotifyService</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">SpotifyService</span><span class="o">.</span><span class="na">class</span><span class="o">);</span></code></pre></figure>

<h3> TrackResponse, Track and Artist classes</h3>
<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TrackResponse</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Tracks</span> <span class="n">tracks</span><span class="o">;</span>

    <span class="kd">public</span> <span class="n">Tracks</span> <span class="nf">getTracks</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">tracks</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTracks</span><span class="o">(</span><span class="n">Tracks</span> <span class="n">tracks</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">tracks</span> <span class="o">=</span> <span class="n">tracks</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Tracks</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Track</span><span class="o">&gt;</span> <span class="n">items</span><span class="o">;</span>

    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Track</span><span class="o">&gt;</span> <span class="nf">getItems</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">items</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setItems</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Track</span><span class="o">&gt;</span> <span class="n">items</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">items</span> <span class="o">=</span> <span class="n">items</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
    </code></pre></figure>

   <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Track</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Artist</span><span class="o">&gt;</span> <span class="n">artists</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">href</span><span class="o">;</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getHref</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">href</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setHref</span><span class="o">(</span><span class="n">String</span> <span class="n">href</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">href</span> <span class="o">=</span> <span class="n">href</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Artist</span><span class="o">&gt;</span> <span class="nf">getArtists</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">artists</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setArtists</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Artist</span><span class="o">&gt;</span> <span class="n">artists</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">artists</span> <span class="o">=</span> <span class="n">artists</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Artist</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>


<h3>RecyclerViewAdapter</h3>
Adapter for displaying the search results in the RecyclerView
<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TracksAdapter</span> <span class="kd">extends</span> <span class="n">RecyclerView</span><span class="o">.</span><span class="na">Adapter</span><span class="o">&lt;</span><span class="n">TracksAdapter</span><span class="o">.</span><span class="na">TrackViewHolder</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Track</span><span class="o">&gt;</span> <span class="n">tracks</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Context</span> <span class="n">context</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">ClickedTrackListener</span> <span class="n">listener</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">TracksAdapter</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">ClickedTrackListener</span> <span class="n">listener</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Track</span><span class="o">&gt;</span> <span class="n">tracks</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">tracks</span> <span class="o">=</span> <span class="n">tracks</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">context</span> <span class="o">=</span> <span class="n">context</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">listener</span> <span class="o">=</span> <span class="n">listener</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">TrackViewHolder</span> <span class="nf">onCreateViewHolder</span><span class="o">(</span><span class="n">ViewGroup</span> <span class="n">viewGroup</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">View</span> <span class="n">itemView</span> <span class="o">=</span> <span class="n">LayoutInflater</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">context</span><span class="o">).</span><span class="na">inflate</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">item_track</span><span class="o">,</span> <span class="n">viewGroup</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
        <span class="kd">final</span> <span class="n">TrackViewHolder</span> <span class="n">trackViewHolder</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">TrackViewHolder</span><span class="o">(</span><span class="n">itemView</span><span class="o">);</span>
        <span class="n">itemView</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">Track</span> <span class="n">track</span> <span class="o">=</span> <span class="n">tracks</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">trackViewHolder</span><span class="o">.</span><span class="na">getPosition</span><span class="o">());</span>
                <span class="n">listener</span><span class="o">.</span><span class="na">clickedTrack</span><span class="o">(</span><span class="n">track</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">});</span>
        <span class="k">return</span> <span class="n">trackViewHolder</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onBindViewHolder</span><span class="o">(</span><span class="n">TrackViewHolder</span> <span class="n">trackViewHolder</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Track</span> <span class="n">track</span> <span class="o">=</span> <span class="n">tracks</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="n">trackViewHolder</span><span class="o">.</span><span class="na">trackName</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">track</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getItemCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">tracks</span><span class="o">.</span><span class="na">size</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">TrackViewHolder</span> <span class="kd">extends</span> <span class="n">RecyclerView</span><span class="o">.</span><span class="na">ViewHolder</span> <span class="o">{</span>

        <span class="kd">private</span> <span class="kd">final</span> <span class="n">TextView</span> <span class="n">trackName</span><span class="o">;</span>

        <span class="kd">public</span> <span class="nf">TrackViewHolder</span><span class="o">(</span><span class="n">View</span> <span class="n">itemView</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">(</span><span class="n">itemView</span><span class="o">);</span>
            <span class="n">trackName</span> <span class="o">=</span> <span class="o">(</span><span class="n">TextView</span><span class="o">)</span> <span class="n">itemView</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">trackName</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>
<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;LinearLayout</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class="na">android:orientation=</span><span class="s">&quot;vertical&quot;</span> <span class="na">android:layout_width=</span><span class="s">&quot;match_parent&quot;</span>
    <span class="na">android:layout_height=</span><span class="s">&quot;match_parent&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;TextView</span>
        <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="na">android:id=</span><span class="s">&quot;@+id/trackName&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/LinearLayout&gt;</span></code></pre></figure>

<h3> TracksActivity</h3>
<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TracksActivity</span> <span class="kd">extends</span> <span class="n">ActionBarActivity</span> <span class="kd">implements</span> <span class="n">ClickedTrackListener</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">RecyclerView</span> <span class="n">trackList</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Track</span><span class="o">&gt;</span> <span class="n">tracks</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_tracks</span><span class="o">);</span>

        <span class="n">trackList</span> <span class="o">=</span> <span class="o">(</span><span class="n">RecyclerView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">trackList</span><span class="o">);</span>
        <span class="n">trackList</span><span class="o">.</span><span class="na">setLayoutManager</span><span class="o">(</span><span class="k">new</span> <span class="nf">LinearLayoutManager</span><span class="o">(</span><span class="k">this</span><span class="o">));</span>
        <span class="kd">final</span> <span class="n">TracksAdapter</span> <span class="n">tracksAdapter</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">TracksAdapter</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="k">this</span><span class="o">,</span> <span class="n">tracks</span><span class="o">);</span>
        <span class="n">trackList</span><span class="o">.</span><span class="na">setAdapter</span><span class="o">(</span><span class="n">tracksAdapter</span><span class="o">);</span>

        <span class="n">Bundle</span> <span class="n">extras</span> <span class="o">=</span> <span class="n">getIntent</span><span class="o">().</span><span class="na">getExtras</span><span class="o">();</span>
        <span class="n">String</span> <span class="n">input</span> <span class="o">=</span> <span class="n">extras</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;input&quot;</span><span class="o">);</span>

        <span class="n">RestAdapter</span> <span class="n">adapter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RestAdapter</span><span class="o">.</span><span class="na">Builder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="s">&quot;http://ws.spotify.com/&quot;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>
        <span class="n">SpotifyService</span> <span class="n">spotifyService</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">SpotifyService</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="n">spotifyService</span><span class="o">.</span><span class="na">searchForTrack</span><span class="o">(</span><span class="n">input</span><span class="o">,</span> <span class="k">new</span> <span class="n">Callback</span><span class="o">&lt;</span><span class="n">TrackResponse</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">TrackResponse</span> <span class="n">trackResponse</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">tracks</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>
                <span class="n">tracks</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">trackResponse</span><span class="o">.</span><span class="na">getTracks</span><span class="o">());</span>
                <span class="n">tracksAdapter</span><span class="o">.</span><span class="na">notifyDataSetChanged</span><span class="o">();</span>
            <span class="o">}</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">RetrofitError</span> <span class="n">error</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">TracksActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="s">&quot;Failure&quot;</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_SHORT</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
                <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="s">&quot;search&quot;</span><span class="o">,</span> <span class="s">&quot;error&quot;</span><span class="o">,</span> <span class="n">error</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">});</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">clickedTrack</span><span class="o">(</span><span class="n">Track</span> <span class="n">track</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Intent</span><span class="o">(</span><span class="n">Intent</span><span class="o">.</span><span class="na">ACTION_VIEW</span><span class="o">,</span> <span class="n">Uri</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">track</span><span class="o">.</span><span class="na">getHref</span><span class="o">()));</span>
        <span class="n">startActivity</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>
<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="o">&lt;</span><span class="n">RelativeLayout</span> <span class="nl">xmlns:</span><span class="n">android</span><span class="o">=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class="nl">xmlns:</span><span class="n">foo</span><span class="o">=</span><span class="s">&quot;http://schemas.android.com/apk/res-auto&quot;</span>
    <span class="nl">xmlns:</span><span class="n">tools</span><span class="o">=</span><span class="s">&quot;http://schemas.android.com/tools&quot;</span> <span class="nl">android:</span><span class="n">layout_width</span><span class="o">=</span><span class="s">&quot;match_parent&quot;</span>
    <span class="nl">android:</span><span class="n">layout_height</span><span class="o">=</span><span class="s">&quot;match_parent&quot;</span> <span class="nl">android:</span><span class="n">paddingLeft</span><span class="o">=</span><span class="s">&quot;@dimen/activity_horizontal_margin&quot;</span>
    <span class="nl">android:</span><span class="n">paddingRight</span><span class="o">=</span><span class="s">&quot;@dimen/activity_horizontal_margin&quot;</span>
    <span class="nl">android:</span><span class="n">paddingTop</span><span class="o">=</span><span class="s">&quot;@dimen/activity_vertical_margin&quot;</span>
    <span class="nl">android:</span><span class="n">paddingBottom</span><span class="o">=</span><span class="s">&quot;@dimen/activity_vertical_margin&quot;</span>
    <span class="nl">tools:</span><span class="n">context</span><span class="o">=</span><span class="s">&quot;no.bekk.liverpool.TracksActivity&quot;</span><span class="o">&gt;</span>

    <span class="o">&lt;</span><span class="n">android</span><span class="o">.</span><span class="na">support</span><span class="o">.</span><span class="na">v7</span><span class="o">.</span><span class="na">widget</span><span class="o">.</span><span class="na">RecyclerView</span>
        <span class="nl">android:</span><span class="n">layout_width</span><span class="o">=</span><span class="s">&quot;match_parent&quot;</span>
        <span class="nl">android:</span><span class="n">layout_height</span><span class="o">=</span><span class="s">&quot;match_parent&quot;</span>
        <span class="nl">android:</span><span class="n">id</span><span class="o">=</span><span class="s">&quot;@+id/trackList&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">android</span><span class="o">.</span><span class="na">support</span><span class="o">.</span><span class="na">v7</span><span class="o">.</span><span class="na">widget</span><span class="o">.</span><span class="na">RecyclerView</span><span class="o">&gt;</span>

<span class="o">&lt;/</span><span class="n">RelativeLayout</span><span class="o">&gt;</span></code></pre></figure>


<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&quot;info&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;num_results&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nt">&quot;limit&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="nt">&quot;offset&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nt">&quot;query&quot;</span><span class="p">:</span> <span class="s2">&quot;\&quot;godset fra drammen\&quot;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;track&quot;</span><span class="p">,</span>
    <span class="nt">&quot;page&quot;</span><span class="p">:</span> <span class="mi">1</span>
  <span class="p">},</span>
  <span class="nt">&quot;tracks&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;album&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;released&quot;</span><span class="p">:</span> <span class="s2">&quot;2008&quot;</span><span class="p">,</span>
        <span class="nt">&quot;href&quot;</span><span class="p">:</span> <span class="s2">&quot;spotify:album:7nrjbBpy8yrueDbKCBY6Ef&quot;</span><span class="p">,</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;2 x femogførr&quot;</span><span class="p">,</span>
        <span class="nt">&quot;availability&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="nt">&quot;territories&quot;</span><span class="p">:</span> <span class="s2">&quot;AD AR AT AU BE BG BO BR CA CH CL CO CR CY CZ DE DK DO EC EE ES FI FR GB GR GT HK HN HR HU IE IS IT LI LT LU LV MC MT MX MY NI NL NO NZ PA PE PH PL PT PY RO SE SG SI SK SV TR TW US UY&quot;</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Godset fra Drammen&quot;</span><span class="p">,</span>
      <span class="nt">&quot;popularity&quot;</span><span class="p">:</span> <span class="s2">&quot;0.36&quot;</span><span class="p">,</span>
      <span class="nt">&quot;external-ids&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;isrc&quot;</span><span class="p">,</span>
          <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;NOFFM0897080&quot;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="nt">&quot;length&quot;</span><span class="p">:</span> <span class="mf">258.786</span><span class="p">,</span>
      <span class="nt">&quot;href&quot;</span><span class="p">:</span> <span class="s2">&quot;spotify:track:67jdp9WXPR3ihTic9WXwmG&quot;</span><span class="p">,</span>
      <span class="nt">&quot;artists&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nt">&quot;href&quot;</span><span class="p">:</span> <span class="s2">&quot;spotify:artist:4AiqdizfguNQoWQ5N6Aaza&quot;</span><span class="p">,</span>
          <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;C-laget&quot;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="nt">&quot;track-number&quot;</span><span class="p">:</span> <span class="s2">&quot;8&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span></code></pre></figure>


          </div>
          <nav class="span4">
            <strong>Android</strong>
            
<ul class="nav nav-pills nav-stacked">

  

  

  
    
      <li class=""><a href="/android101/pages/android-app-structure-and-components.html">App Structure and Components</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/android101/pages/view-layout.html">View Layout</a></li>
    
  
    
  


  

  

  
    
  
    
  
    
      <li class=""><a href="/android101/pages/common-view-controls.html">Common View Controls</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  

  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/android101/pages/list-recycler-view.html">Lists and RecyclerView</a></li>
    
  
    
  
    
  
    
  
    
  
    
  

  
</ul>
            
            <strong>Network Communication</strong>
            
<ul class="nav nav-pills nav-stacked">

  

  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/android101/pages/working-in-the-background.html">Working In the Background</a></li>
    
  


  

  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/android101/pages/retrofit.html">Consume REST APIs with Retrofit</a></li>
    
  
    
  
    
  

  
</ul>

            <strong>Workshop</strong>
            
<ul class="nav nav-pills nav-stacked">

  

  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/android101/pages/prerequisites.html">Prerequisites</a></li>
    
  
    
  
    
  
    
  


  

  

  
    
  
    
      <li class=""><a href="/android101/pages/assignments.html">Assignments</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  

  
    
  
    
  
    
  
    
  
    
  
    
      <li class="active"><a href="/android101/pages/manuscript.html">Manuscript</a></li>
    
  
    
  
    
  
    
  
    
  

  
</ul>
          </nav>
        </div>
      </div>

    </body>
</html>
